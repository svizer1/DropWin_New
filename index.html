<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>DropWin Casino</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="particles" id="particles"></div>

<div class="header">
  <div class="logo">ğŸ’ DROPWIN</div>
  <div class="balance-container">
    <div class="balance">ğŸ’° <span id="balance">0</span>â‚½</div>
    <button class="auth-btn" id="authBtn">Ğ’Ğ¾Ğ¹Ñ‚Ğ¸</button>
  </div>
</div>

<div class="content">
  <div class="games-list">
    <div class="game-icon" onclick="location.href='games/slots.html'"><div class="game-icon-emoji">ğŸ°</div><div class="game-icon-name">Ğ¡Ğ»Ğ¾Ñ‚Ñ‹</div></div>
    <div class="game-icon" onclick="location.href='games/miner.html'"><div class="game-icon-emoji">ğŸ’</div><div class="game-icon-name">ĞœĞ¸Ğ½Ñ‘Ñ€</div></div>
    <div class="game-icon" onclick="location.href='games/roulette.html'"><div class="game-icon-emoji">ğŸ¡</div><div class="game-icon-name">Ğ ÑƒĞ»ĞµÑ‚ĞºĞ°</div></div>
    <div class="game-icon" onclick="location.href='games/cards.html'"><div class="game-icon-emoji">ğŸƒ</div><div class="game-icon-name">ĞšĞ°Ñ€Ñ‚Ñ‹</div></div>
    <div class="game-icon" onclick="location.href='games/dice.html'"><div class="game-icon-emoji">ğŸ²</div><div class="game-icon-name">ĞšĞ¾ÑÑ‚Ğ¸</div></div>
    <div class="game-icon" onclick="location.href='games/crash.html'"><div class="game-icon-emoji">ğŸš€</div><div class="game-icon-name">ĞšÑ€Ğ°Ñˆ</div></div>
    <div class="game-icon" onclick="location.href='games/plinko.html'"><div class="game-icon-emoji">ğŸ¯</div><div class="game-icon-name">Plinko</div></div>
    <div class="game-icon" onclick="location.href='games/dino-throw.html'"><div class="game-icon-emoji">ğŸ¦–</div><div class="game-icon-name">Dino Throw</div></div>
    <div class="game-icon" onclick="location.href='crypto.html'"><div class="game-icon-emoji">ğŸ“ˆ</div><div class="game-icon-name">ĞĞºÑ†Ğ¸Ğ¸: ĞšÑ€Ğ¸Ğ¿Ñ‚Ğ°</div></div>
    <div class="game-icon" onclick="location.href='games/battles.html'"><div class="game-icon-emoji">âš”ï¸</div><div class="game-icon-name">Ğ‘Ğ°Ñ‚Ñ‚Ğ»Ñ‹ ĞšĞµĞ¹ÑĞ¾Ğ²</div></div>
  </div>
</div>

<div class="nav">
  <button class="nav-btn active"><span>ğŸ </span><span class="nav-label">Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ</span></button>
  <button class="nav-btn" onclick="location.href='profile.html'"><span>ğŸ‘¤</span><span class="nav-label">ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</span></button>
  <button class="nav-btn" onclick="location.href='register.html'"><span>ğŸ”‘</span><span class="nav-label">Ğ’Ñ…Ğ¾Ğ´</span></button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBVra2JN-C7-1b_Qa4cU8--XvJ83lymiM8",
    authDomain: "dropwin-8d94b.firebaseapp.com",
    projectId: "dropwin-8d94b",
    storageBucket: "dropwin-8d94b.firebasestorage.app",
    messagingSenderId: "988974289403",
    appId: "1:988974289403:web:886d34e6f65920a105fb5e",
    measurementId: "G-BK010MHN8N"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  function createParticles() {
    const container = document.getElementById('particles');
    for (let i = 0; i < 40; i++) {
      const p = document.createElement('div');
      p.className = 'particle';
      p.style.width = p.style.height = Math.random() * 3 + 1 + 'px';
      p.style.left = Math.random() * 100 + '%';
      p.style.animationDuration = Math.random() * 15 + 10 + 's';
      p.style.animationDelay = Math.random() * 5 + 's';
      container.appendChild(p);
    }
  }
  createParticles();

  let currentUser = null;

  function loadCurrentUser() {
    onAuthStateChanged(auth, (user) => {
      if (user) {
        getDoc(doc(db, 'users', user.uid)).then((docSnap) => {
          if (docSnap.exists()) {
            currentUser = docSnap.data();
            document.getElementById('balance').textContent = currentUser.balance || 0;
            document.getElementById('authBtn').textContent = currentUser.isGuest ? 'Ğ“Ğ¾ÑÑ‚ÑŒ' : currentUser.username;
            document.getElementById('authBtn').onclick = () => location.href = 'profile.html';
          } else {
            document.getElementById('balance').textContent = '0';
            document.getElementById('authBtn').textContent = 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸';
            document.getElementById('authBtn').onclick = () => location.href = 'register.html';
          }
        }).catch((error) => {
          console.error('Error loading user:', error);
        });
      } else {
        const username = localStorage.getItem('dropwin_current_username');
        if (username === 'Ğ“Ğ¾ÑÑ‚ÑŒ') {
          const users = JSON.parse(localStorage.getItem('dropwin_users')) || [];
          currentUser = users.find(u => u.username === username);
          if (currentUser) {
            document.getElementById('balance').textContent = currentUser.balance || 0;
            document.getElementById('authBtn').textContent = 'Ğ“Ğ¾ÑÑ‚ÑŒ';
            document.getElementById('authBtn').onclick = () => location.href = 'profile.html';
          }
        } else {
          document.getElementById('balance').textContent = '0';
          document.getElementById('authBtn').textContent = 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸';
          document.getElementById('authBtn').onclick = () => location.href = 'register.html';
        }
      }
    });
  }

  document.addEventListener('DOMContentLoaded', loadCurrentUser);
</script>
</body>
</html>
